# -*- coding: utf-8 -*-
"""project 2.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1JKf6aZyz1JF6CwnTdPxW5QjWvbwe2m7-
"""

import pandas as pd
df = pd.read_csv("diabetes.csv")

print("Total Rows and Columns:", df.shape)
print("\nDataset Info:\n")
print(df.info())

missing_values = df.isnull().sum().sum()

if missing_values > 0:
    print("Missing values found.\n")
    print(df.isnull().sum())
else:
    print("No missing values found.")

import matplotlib.pyplot as plt

target_col = df.columns[-1]

counts = df[target_col].value_counts()
print("Class Distribution:\n", counts)

if counts.min() / counts.max() < 0.5:
    print("Data is Highly Imbalanced")
else:
    print("Data is Not Highly Imbalanced")

plt.figure()
counts.plot(kind='bar')
plt.title("No of Diabetic and Non Diabetic Patients")
plt.xlabel("Class")
plt.ylabel("Count")
plt.show()

avg_age = df.groupby(target_col)["Age"].mean()

plt.figure()
bars = plt.bar(avg_age.index.astype(str), avg_age.values)

for i in range(len(avg_age)):
    plt.text(i, avg_age.values[i], round(avg_age.values[i],2))

plt.title("Average Age of Diabetic and Non Diabetic Patients")
plt.xlabel("Class")
plt.ylabel("Average Age")
plt.show()

avg_bmi = df.groupby(target_col)["BMI"].mean()

plt.figure()
bars = plt.bar(avg_bmi.index.astype(str), avg_bmi.values)

for i in range(len(avg_bmi)):
    plt.text(i, avg_bmi.values[i], round(avg_bmi.values[i],2))

plt.title("Average BMI of Diabetic and Non Diabetic Patients")
plt.xlabel("Class")
plt.ylabel("Average BMI")
plt.show()

avg_preg = df.groupby(target_col)["Pregnancies"].mean()

plt.figure()
bars = plt.bar(avg_preg.index.astype(str), avg_preg.values)

for i in range(len(avg_preg)):
    plt.text(i, avg_preg.values[i], round(avg_preg.values[i],2))

plt.title("Average Pregnancies of Diabetic and Non Diabetic Patients")
plt.xlabel("Class")
plt.ylabel("Average Pregnancies")
plt.show()

from sklearn.model_selection import train_test_split

X = df.iloc[:, :-1]
y = df.iloc[:, -1]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=42)

from sklearn.ensemble import RandomForestClassifier
from sklearn.tree import DecisionTreeClassifier

rf = RandomForestClassifier(random_state=42)
dt = DecisionTreeClassifier(random_state=42)

rf.fit(X_train, y_train)
dt.fit(X_train, y_train)

from sklearn.metrics import accuracy_score, precision_score, recall_score

rf_pred = rf.predict(X_test)
dt_pred = dt.predict(X_test)

results = {
    "RandomForest": {
        "Accuracy": accuracy_score(y_test, rf_pred),
        "Precision": precision_score(y_test, rf_pred),
        "Recall": recall_score(y_test, rf_pred)
    },
    "DecisionTree": {
        "Accuracy": accuracy_score(y_test, dt_pred),
        "Precision": precision_score(y_test, dt_pred),
        "Recall": recall_score(y_test, dt_pred)
    }
}

print(results)

metrics = ["Accuracy", "Precision", "Recall"]

rf_scores = [results["RandomForest"][m] for m in metrics]
dt_scores = [results["DecisionTree"][m] for m in metrics]

plt.figure()
plt.plot(metrics, rf_scores)
plt.plot(metrics, dt_scores)

plt.xlabel("Metrics")
plt.ylabel("Score")
plt.title("Model Comparison")
plt.legend(["RandomForest", "DecisionTree"])
plt.show()

"""Hotel Rental

"""

hotel = pd.read_csv("hotel_rental.csv")

print("Total Rows and Columns:", hotel.shape)
print("\nDataset Info:\n")
print(hotel.info())

hotel = hotel.select_dtypes(include=['number'])

X = hotel.iloc[:, :-1]
y = hotel.iloc[:, -1]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

from sklearn.neighbors import KNeighborsRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.linear_model import LinearRegression

knn = KNeighborsRegressor()
rf_reg = RandomForestRegressor(random_state=42)
lr = LinearRegression()

knn.fit(X_train, y_train)
rf_reg.fit(X_train, y_train)
lr.fit(X_train, y_train)

from sklearn.metrics import mean_absolute_error, mean_absolute_percentage_error

models = {
    "KNN": knn.predict(X_test),
    "RandomForest": rf_reg.predict(X_test),
    "LinearRegression": lr.predict(X_test)
}

performance = {}

for name, pred in models.items():
    performance[name] = {
        "MAE": mean_absolute_error(y_test, pred),
        "MAPE": mean_absolute_percentage_error(y_test, pred)
    }

print(performance)

plt.figure()
plt.plot(y_test.values)
plt.plot(models["KNN"])
plt.plot(models["RandomForest"])
plt.plot(models["LinearRegression"])

plt.legend(["Actual", "KNN", "RandomForest", "LinearRegression"])
plt.title("Actual vs Predicted Comparison")
plt.show()

